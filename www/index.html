<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link rel="stylesheet" href="libro.css">
<title>LibroJS</title>
</head>

<body>

<div style="border: 1px solid gray; padding: .4em; text-align: center;">
	<button onclick="libro.previousPage()" style="float:left">&lt;&lt;</button>
	<button onclick="libro.nextPage()" style="float:right">&gt;&gt;</button>
	<button onclick="window.location.hash = 'modalSideMenu'">⇄</button>
	<button onclick="window.location.hash = 'modalWindow'">modal</button>
	<button onclick="window.location.hash = 'modalTopMenu'">⇅</button>
</div>

<div class="modal" id="returnDialog">
	<div style="padding: 0.5em; text-align: center;">
		<p>Are you sure you want to return to the previous page?</p>
		<button onclick="window.history.back();">Cancel</button>&nbsp;&nbsp;
		<button onclick="window.history.go(-2);" id="returnButton">Return</button>
	</div>
</div>

<div class="page" id="firstPage">
	<h1>LibroJS - <span style="color:#004;">First Page</span></h1>
	<p>If you are viewing this page (firstPage), it means that the current browser URL ends with "#firstPage"</p>
	#firstPage | <a href="#secondPage">#secondPage</a> | <a href="#thirdPage">#thirdPage</a> | <a href="#fourthPage">#fourthPage</a>
</div>

<div class="page" id="secondPage">
	<h1>LibroJS - <span style="color:#040;">Second Page</span></h1>
	<p>If you are viewing this page (secondPage), it means that the current browser URL ends with "#secondPage"</p>
	<a href="#firstPage">#firstPage</a> | #secondPage | <a href="#thirdPage">#thirdPage</a> | <a href="#fourthPage">#fourthPage</a>
</div>

<div class="page" id="thirdPage">
	<h1>LibroJS - <span style="color:#400;">Third Page</span></h1>
	<p>If you are viewing this page (thirdPage), it means that the current browser URL ends with "#thirdPage"</p>
	<a href="#firstPage">#firstPage</a> | <a href="#secondPage">#secondPage</a> | #thirdPage | <a href="#fourthPage">#fourthPage</a>
</div>

<div class="page" id="fourthPage">
	<h1>LibroJS - <span style="color:#440;">Fourth Page</span></h1>
	<p>If you are viewing this page (fourthPage), it means that the current browser URL ends with "#fourthPage"</p>
	<a href="#firstPage">#firstPage</a> | <a href="#secondPage">#secondPage</a> | <a href="#thirdPage">#thirdPage</a> | #fourthPage
</div>

<div class="modal" id="modalWindow">
	<div style="padding: 0.5em;">
		<h1>LibroJS - <span style="color:#444;">Modal Window</span></h1>
		<p>If you are viewing this modal (modalWindow), it means that the current browser URL ends with "#modalWindow"</p>
		<a href="#firstPage">#firstPage</a> | <a href="#secondPage">#secondPage</a> | <a href="#thirdPage">#thirdPage</a> | <a href="#fourthPage">#fourthPage</a>
		<br><br>
		<a href="javascript:window.history.back();">(hide modal)</a>
	</div>
</div>

<div class="modal menu" id="modalSideMenu" transition="drawerleft">
	<div style="margin: 0; max-width: 300px; padding: 0.5em;
			position: fixed; top: 0; bottom: 0; left: 0; overflow: auto;">
		<h2>Modal - <span style="color:#444;">Side Menu</span></h2>
		<p>If you are viewing this modal (modalSideMenu), it means that the current browser URL ends with "#modalSideMenu"</p>
		<label style="white-space:nowrap;">
			Page transition
			<select onchange="libro.setDefaultPageTransition(this.value);">
				<option value="none">None</option>
				<option value="fade" selected>Fade (default)</option>
				<option value="pop">Pop</option>
				<option value="flip">Flip</option>
				<option value="fliprev">Flip Reverse</option>
				<option value="fliporder">Flip Order</option>
				<option value="slide">Slide</option>
				<option value="sliderev">Slide Reverse</option>
				<option value="slideorder">Slide Order</option>
				<option value="drawertop">Drawer Top</option>
				<option value="drawerbottom">Drawer Bottom</option>
				<option value="drawerleft">Drawer Left</option>
				<option value="drawerright">Drawer Right</option>
			</select>
		</label>
		<br>
		<br>
		<label style="white-space:nowrap;">
			Modal transition
			<select onchange="libro.setDefaultModalTransition(this.value);">
				<option value="none">None</option>
				<option value="fade">Fade</option>
				<option value="pop" selected>Pop (default)</option>
				<option value="flip">Flip</option>
				<option value="fliprev">Flip Reverse</option>
				<option value="slide">Slide</option>
				<option value="sliderev">Slide Reverse</option>
				<option value="drawertop">Drawer Top</option>
				<option value="drawerbottom">Drawer Bottom</option>
				<option value="drawerleft">Drawer Left</option>
				<option value="drawerright">Drawer Right</option>
			</select>
		</label>
		<br>
		<br>
		<label style="white-space:nowrap;"><input style="vertical-align: middle;" type="checkbox" onchange="libro.setSwipePageSwitch(this.checked);" checked> libro.setSwipePageSwitch</label>
		<br>
		<br>
		<label style="white-space:nowrap;"><input style="vertical-align: middle;" type="checkbox" onchange="libro.setSwipeModalSwitch(this.checked);" checked> libro.setSwipeModalSwitch</label>
		<br>
		<br>
		<label style="white-space:nowrap;"><input style="vertical-align: middle;" type="checkbox" onchange="libro.setCanvasTouchable(this.checked);" checked> libro.setCanvasTouchable</label>
		<br>
		<br>
		<a href="javascript:window.history.back();">(hide modal)</a>
	</div>
</div>

<div class="modal menu" id="modalTopMenu" transition="drawertop">
	<div style="margin: 0 0 auto auto; max-width: 300px; padding: 0.5em;">
		<h2>Modal - <span style="color:#444;">Top Menu</span></h2>
		<p>If you are viewing this modal (modalTopMenu), it means that the current browser URL ends with "#modalTopMenu"</p>
		<a href="javascript:createCanvasPage();">Canvas Page</a><br>
		<br>
		<a href="javascript:createDynamicPages();">Dynamic Pages</a><br>
		<br>
		<a href="javascript:window.history.back(); if (confirm('Open Folder Examples?')) window.location.href = 'examples/';">Folder Examples</a><br>
		<br>
		<a href="javascript:window.history.back(); if (confirm('Execute QUnit Test Cases?')) window.location.href = 'tests/tests.html';">QUnit Test Cases</a><br>
		<br>
		<a href="javascript:window.history.back();">(hide modal)</a>
	</div>
</div>

<br>
<label style="white-space:nowrap;"><input style="vertical-align: middle;" type="checkbox" onchange="libro.setLogEnabled(this.checked);" checked> Enable log</label>
<button style="margin-left: .5em;" onclick="logMonitor.innerHTML = '';">Clear log</button>
<button style="margin-left: .5em;" onclick="executeCommand();">Command</button>

<div id="logMonitor" style="font-family: monospace; color: darkgray;"></div>

<script src="libro.js"></script>

<script>
var logMonitor = document.getElementById('logMonitor');

// Enable swipe page switch:
libro.setSwipePageSwitch(true);

// Enable swipe modal switch:
libro.setSwipeModalSwitch(true);

// Set browser error callback:
window.onerror = function (msg, url, lineNo, columnNo, error) {
	logMonitor.innerHTML = logMonitor.innerHTML + '<br>' + (new Date().toLocaleString()) + ': <span style="color:red;">window.onerror...' +
		'<br>&nbsp;&nbsp;&nbsp;&nbsp;msg: ' + msg +
		'<br>&nbsp;&nbsp;&nbsp;&nbsp;url: ' + url +
		'<br>&nbsp;&nbsp;&nbsp;&nbsp;lineNo: ' + lineNo + ', columnNo: ' + columnNo +
		'<br>&nbsp;&nbsp;&nbsp;&nbsp;error: ' + error + '</span>';
};

// Set global callbacks:
libro.onLoad = function() {
	if (libro.isLogEnabled()) logMonitor.innerHTML = logMonitor.innerHTML + '<br>' + (new Date().toLocaleString()) + ': <span style="color:gray;">libro.onLoad()</span>';
}
libro.onUnload = function() {
	if (libro.isLogEnabled()) logMonitor.innerHTML = logMonitor.innerHTML + '<br>' + (new Date().toLocaleString()) + ': <span style="color:gray;">libro.onUnload()</span>';
}
libro.onPause = function(pageElement) {
	if (libro.isLogEnabled()) logMonitor.innerHTML = logMonitor.innerHTML + '<br>' + (new Date().toLocaleString()) + ': <span style="color:gray;">libro.onPause(' + (pageElement? pageElement.id: '') + ')</span>';
}
libro.onResume = function(pageElement) {
	if (libro.isLogEnabled()) logMonitor.innerHTML = logMonitor.innerHTML + '<br>' + (new Date().toLocaleString()) + ': <span style="color:gray;">libro.onResume(' + (pageElement? pageElement.id: '') + ')</span>';
}
libro.onResize = function(pageElement) {
	if (libro.isLogEnabled()) logMonitor.innerHTML = logMonitor.innerHTML + '<br>' + (new Date().toLocaleString()) + ': <span style="color:gray;">libro.onResize(' + (pageElement? pageElement.id: '') + ')</span>';
}
libro.onUpdateHash = function(hashChangeEvent) {
	if (libro.isLogEnabled()) logMonitor.innerHTML = logMonitor.innerHTML + '<br>' + (new Date().toLocaleString()) + ': <span style="color:gray;">libro.onUpdateHash(hashChangeEvent)' +
		'<br>&nbsp;&nbsp;&nbsp;&nbsp; hashChangeEvent.newURL: ..' + (hashChangeEvent.newURL? hashChangeEvent.newURL.substring(hashChangeEvent.newURL.lastIndexOf('/')): '') +
		'<br>&nbsp;&nbsp;&nbsp;&nbsp; hashChangeEvent.oldURL: ..' + (hashChangeEvent.oldURL? hashChangeEvent.oldURL.substring(hashChangeEvent.oldURL.lastIndexOf('/')): '') + '</span>';
}
libro.onSwitchPage = function(pageElement, referrerElement) {
	if (libro.isLogEnabled()) logMonitor.innerHTML = logMonitor.innerHTML + '<br>' + (new Date().toLocaleString()) + ': <span style="color:gray;">libro.onSwitchPage(' + pageElement.id + ', ' + (referrerElement? referrerElement.id: '') + ')</span>';
}
libro.onSwitchModal = function(booleanState, modalElement, referrerElement) {
	if (libro.isLogEnabled()) logMonitor.innerHTML = logMonitor.innerHTML + '<br>' + (new Date().toLocaleString()) + ': <span style="color:gray;">libro.onSwitchModal(' + booleanState + ', ' + modalElement.id + ', ' + referrerElement.id + ')</span>';
	if (referrerElement.id === 'canvasPage' && (modalElement.id === 'returnDialog' || modalElement.id === 'modalWindow')) {
		libro.setRunning(!booleanState); // Pause while returnDialog or modalWindow appears over canvasPage.
	}
}
libro.onKeyDown = function(keyEvent, pageElement) {
	if (libro.isLogEnabled()) logMonitor.innerHTML = logMonitor.innerHTML + '<br>' + (new Date().toLocaleString()) + ': <span style="color:gray;">libro.onKeyDown(' + keyEvent.keyCode + ', ' + pageElement.id + ')</span>';
};
libro.onKeyUp = function(keyEvent, pageElement) {
	if (libro.isLogEnabled()) logMonitor.innerHTML = logMonitor.innerHTML + '<br>' + (new Date().toLocaleString()) + ': <span style="color:gray;">libro.onKeyUp(' + keyEvent.keyCode + ', ' + pageElement.id + ')</span>';
};

// Set returnDialog callbacks:
var returnDialogElement = document.getElementById('returnDialog');
var returnButtonElement = document.getElementById('returnButton');
returnDialogElement.onShow = function(queryData, referrerElement) {
	if (libro.isLogEnabled()) logMonitor.innerHTML = logMonitor.innerHTML + '<br>' + (new Date().toLocaleString()) + ': <span style="color:#444;">returnDialogElement.onShow(' + queryData + ', ' + (referrerElement? referrerElement.id: '') + ')</span>';
	returnButtonElement.focus();
};
returnDialogElement.onHide = function(nextQueryData, nextElement) {
	if (libro.isLogEnabled()) logMonitor.innerHTML = logMonitor.innerHTML + '<br>' + (new Date().toLocaleString()) + ': <span style="color:#444;">returnDialogElement.onHide(' + nextQueryData + ', ' + (nextElement? nextElement.id: '') + ')</span>';
	if (nextQueryData && (nextQueryData === 'returnDialog')) {
		window.location.hash = nextElement.id;
	}
};
returnDialogElement.onUpdateQuery = function(queryData) {
	if (libro.isLogEnabled()) logMonitor.innerHTML = logMonitor.innerHTML + '<br>' + (new Date().toLocaleString()) + ': <span style="color:#444;">returnDialogElement.onUpdateQuery(' + queryData + ')</span>';
};

// Set firstPage callbacks:
var firstPageElement = document.getElementById('firstPage');
firstPageElement.onShow = function(queryData, referrerElement) {
	if (libro.isLogEnabled()) logMonitor.innerHTML = logMonitor.innerHTML + '<br>' + (new Date().toLocaleString()) + ': <span style="color:#004;">firstPageElement.onShow(' + queryData + ', ' + (referrerElement? referrerElement.id: '') + ')</span>';
	if (queryData && (queryData === 'returnDialog')) {
		setTimeout(function() { // Timeout required to create history entry for WebKit browsers.
			window.location.hash = 'firstPage';
		}, 100);
	}
};
firstPageElement.onHide = function(nextQueryData, nextElement) {
	if (libro.isLogEnabled()) logMonitor.innerHTML = logMonitor.innerHTML + '<br>' + (new Date().toLocaleString()) + ': <span style="color:#004;">firstPageElement.onHide(' + nextQueryData + ', ' + (nextElement? nextElement.id: '') + ')</span>';
};
firstPageElement.onUpdateQuery = function(queryData) {
	if (libro.isLogEnabled()) logMonitor.innerHTML = logMonitor.innerHTML + '<br>' + (new Date().toLocaleString()) + ': <span style="color:#004;">firstPageElement.onUpdateQuery(' + queryData + ')</span>';
	if (queryData && (queryData === 'returnDialog')) {
		window.location.hash = 'returnDialog';
	}
};

// Set secondPage callbacks:
var secondPageElement = document.getElementById('secondPage');
secondPageElement.onShow = function(queryData, referrerElement) {
	if (libro.isLogEnabled()) logMonitor.innerHTML = logMonitor.innerHTML + '<br>' + (new Date().toLocaleString()) + ': <span style="color:#040;">secondPageElement.onShow(' + queryData + ', ' + (referrerElement? referrerElement.id: '') + ')</span>';
};
secondPageElement.onHide = function(nextQueryData, nextElement) {
	if (libro.isLogEnabled()) logMonitor.innerHTML = logMonitor.innerHTML + '<br>' + (new Date().toLocaleString()) + ': <span style="color:#040;">secondPageElement.onHide(' + nextQueryData + ', ' + (nextElement? nextElement.id: '') + ')</span>';
};
secondPageElement.onUpdateQuery = function(queryData) {
	if (libro.isLogEnabled()) logMonitor.innerHTML = logMonitor.innerHTML + '<br>' + (new Date().toLocaleString()) + ': <span style="color:#040;">secondPageElement.onUpdateQuery(' + queryData + ')</span>';
};

// Set thirdPage callbacks:
var thirdPageElement = document.getElementById('thirdPage');
thirdPageElement.onShow = function(queryData, referrerElement) {
	if (libro.isLogEnabled()) logMonitor.innerHTML = logMonitor.innerHTML + '<br>' + (new Date().toLocaleString()) + ': <span style="color:#400;">thirdPageElement.onShow(' + queryData + ', ' + (referrerElement? referrerElement.id: '') + ')</span>';
};
thirdPageElement.onHide = function(nextQueryData, nextElement) {
	if (libro.isLogEnabled()) logMonitor.innerHTML = logMonitor.innerHTML + '<br>' + (new Date().toLocaleString()) + ': <span style="color:#400;">thirdPageElement.onHide(' + nextQueryData + ', ' + (nextElement? nextElement.id: '') + ')</span>';
};
thirdPageElement.onUpdateQuery = function(queryData) {
	if (libro.isLogEnabled()) logMonitor.innerHTML = logMonitor.innerHTML + '<br>' + (new Date().toLocaleString()) + ': <span style="color:#400;">thirdPageElement.onUpdateQuery(' + queryData + ')</span>';
};

// Set fourthPage callbacks:
var fourthPageElement = document.getElementById('fourthPage');
fourthPageElement.onShow = function(queryData, referrerElement) {
	if (libro.isLogEnabled()) logMonitor.innerHTML = logMonitor.innerHTML + '<br>' + (new Date().toLocaleString()) + ': <span style="color:#440;">fourthPageElement.onShow(' + queryData + ', ' + (referrerElement? referrerElement.id: '') + ')</span>';
};
fourthPageElement.onHide = function(nextQueryData, nextElement) {
	if (libro.isLogEnabled()) logMonitor.innerHTML = logMonitor.innerHTML + '<br>' + (new Date().toLocaleString()) + ': <span style="color:#440;">fourthPageElement.onHide(' + nextQueryData + ', ' + (nextElement? nextElement.id: '') + ')</span>';
};
fourthPageElement.onUpdateQuery = function(queryData) {
	if (libro.isLogEnabled()) logMonitor.innerHTML = logMonitor.innerHTML + '<br>' + (new Date().toLocaleString()) + ': <span style="color:#440;">fourthPageElement.onUpdateQuery(' + queryData + ')</span>';
};

// Set modalWindow callbacks:
var modalWindowElement = document.getElementById('modalWindow');
modalWindowElement.onShow = function(queryData, referrerElement) {
	if (libro.isLogEnabled()) logMonitor.innerHTML = logMonitor.innerHTML + '<br>' + (new Date().toLocaleString()) + ': <span style="color:#444;">modalWindowElement.onShow(' + queryData + ', ' + (referrerElement? referrerElement.id: '') + ')</span>';
};
modalWindowElement.onHide = function(nextQueryData, nextElement) {
	if (libro.isLogEnabled()) logMonitor.innerHTML = logMonitor.innerHTML + '<br>' + (new Date().toLocaleString()) + ': <span style="color:#444;">modalWindowElement.onHide(' + nextQueryData + ', ' + (nextElement? nextElement.id: '') + ')</span>';
};
modalWindowElement.onUpdateQuery = function(queryData) {
	if (libro.isLogEnabled()) logMonitor.innerHTML = logMonitor.innerHTML + '<br>' + (new Date().toLocaleString()) + ': <span style="color:#444;">modalWindowElement.onUpdateQuery(' + queryData + ')</span>';
};

// Set modalSideMenu callbacks:
var modalSideMenuElement = document.getElementById('modalSideMenu');
modalSideMenuElement.onShow = function(queryData, referrerElement) {
	if (libro.isLogEnabled()) logMonitor.innerHTML = logMonitor.innerHTML + '<br>' + (new Date().toLocaleString()) + ': <span style="color:#444;">modalSideMenuElement.onShow(' + queryData + ', ' + (referrerElement? referrerElement.id: '') + ')</span>';
};
modalSideMenuElement.onHide = function(nextQueryData, nextElement) {
	if (libro.isLogEnabled()) logMonitor.innerHTML = logMonitor.innerHTML + '<br>' + (new Date().toLocaleString()) + ': <span style="color:#444;">modalSideMenuElement.onHide(' + nextQueryData + ', ' + (nextElement? nextElement.id: '') + ')</span>';
};
modalSideMenuElement.onUpdateQuery = function(queryData) {
	if (libro.isLogEnabled()) logMonitor.innerHTML = logMonitor.innerHTML + '<br>' + (new Date().toLocaleString()) + ': <span style="color:#444;">modalSideMenuElement.onUpdateQuery(' + queryData + ')</span>';
};

// Set modalTopMenu callbacks:
var modalTopMenuElement = document.getElementById('modalTopMenu');
modalTopMenuElement.onShow = function(queryData, referrerElement) {
	if (libro.isLogEnabled()) logMonitor.innerHTML = logMonitor.innerHTML + '<br>' + (new Date().toLocaleString()) + ': <span style="color:#444;">modalTopMenuElement.onShow(' + queryData + ', ' + (referrerElement? referrerElement.id: '') + ')</span>';
};
modalTopMenuElement.onHide = function(nextQueryData, nextElement) {
	if (libro.isLogEnabled()) logMonitor.innerHTML = logMonitor.innerHTML + '<br>' + (new Date().toLocaleString()) + ': <span style="color:#444;">modalTopMenuElement.onHide(' + nextQueryData + ', ' + (nextElement? nextElement.id: '') + ')</span>';
};
modalTopMenuElement.onUpdateQuery = function(queryData) {
	if (libro.isLogEnabled()) logMonitor.innerHTML = logMonitor.innerHTML + '<br>' + (new Date().toLocaleString()) + ': <span style="color:#444;">modalTopMenuElement.onUpdateQuery(' + queryData + ')</span>';
};

// Create Canvas Page and set its callbacks/functions/variables:
var moveStep = 5;
var boxSize = 10;
var xPos = yPos = 0;
var xGrow = yGrow = true;
var canvasPageElement = null;
function createCanvasPage() {
	// Create a new page element:
	canvasPageElement = libro.createPage('<canvas class="page" id="canvasPage"></canvas>', 'modalWindow');
	canvasPageElement.width = 320;
	// Set the new created page callbacks:
	canvasPageElement.onShow = canvasOnShow;
	canvasPageElement.onHide = canvasOnHide;
	canvasPageElement.onUpdateQuery = canvasOnUpdateQuery;
	canvasPageElement.onCanvasTouchableStart = canvasOnTouch;
	canvasPageElement.onCanvasTouchableMove = canvasOnTouch;
	canvasPageElement.onUpdate = canvasOnUpdate;
	canvasPageElement.onDraw = canvasOnDraw;
	// Go to the new created page:
	window.location.hash = 'canvasPage?returnDialog';
}
function canvasOnShow(queryData, referrerElement) {
	if (libro.isLogEnabled()) logMonitor.innerHTML = logMonitor.innerHTML + '<br>' + (new Date().toLocaleString()) + ': <span style="color:#444;">canvasPageElement.onShow(' + queryData + ', ' + (referrerElement? referrerElement.id: '') + ')</span>';
	if (queryData && (queryData === 'returnDialog')) {
		window.location.hash = 'canvasPage';
	}
};
function canvasOnHide(nextQueryData, nextElement) {
	if (libro.isLogEnabled()) logMonitor.innerHTML = logMonitor.innerHTML + '<br>' + (new Date().toLocaleString()) + ': <span style="color:#444;">canvasPageElement.onHide(' + nextQueryData + ', ' + (nextElement? nextElement.id: '') + ')</span>';
	if (nextElement) {
		libro.deletePage('canvasPage');
	}
};
function canvasOnUpdateQuery(queryData) {
	if (libro.isLogEnabled()) logMonitor.innerHTML = logMonitor.innerHTML + '<br>' + (new Date().toLocaleString()) + ': <span style="color:#444;">canvasPageElement.onUpdateQuery(' + queryData + ')</span>';
	if (queryData && (queryData === 'returnDialog')) {
		window.location.hash = 'returnDialog';
	}
};
function canvasOnTouch(touchEvent) {
	xPos = touchEvent.changedTouches[0].pageX - canvasPageElement.offsetLeft;
	yPos = touchEvent.changedTouches[0].pageY - canvasPageElement.offsetTop;
}
function canvasOnUpdate() {
	if (xGrow) {
		if (xPos + boxSize < canvasPageElement.offsetWidth) {
			xPos += moveStep;
		} else xGrow = false;
	} else {
		if (xPos > 0) {
			xPos -= moveStep;
		} else xGrow = true;
	}
	if (yGrow) {
		if (yPos + boxSize < canvasPageElement.offsetHeight) {
			yPos += moveStep;
		} else yGrow = false;
	} else {
		if (yPos > 0) {
			yPos -= moveStep;
		} else yGrow = true;
	}
};
function canvasOnDraw() {
	// Clear the canvas (smoothly):
	canvasPageElement.canvasContext.fillStyle = "rgba(211, 211, 211, 0.25)";
	canvasPageElement.canvasContext.fillRect(0, 0, canvasPageElement.width, canvasPageElement.height);
	// Draw text contents:
	canvasPageElement.canvasContext.fillStyle = "#000000";
	canvasPageElement.canvasContext.font = "bold 40px serif";
	canvasPageElement.canvasContext.strokeText('Canvas Page', 10, 40);
	canvasPageElement.canvasContext.font = "14px serif";
	canvasPageElement.canvasContext.fillText('It is a Canvas Page, press back to return.', 10, 70);
	// Draw the animated red rectangle:
	canvasPageElement.canvasContext.fillStyle = "#FF0000";
	canvasPageElement.canvasContext.fillRect(xPos, yPos, boxSize, boxSize);
};

// Create Dynamic Pages and set its callbacks/functions/variables:
var dynamicPagesIds = [];
function createDynamicPages() {
	// Create a new page element:
	var dynamicPageElement = libro.createPage('<div class="page" id="1">' +
			'<h1>LibroJS - Page 1</h1>' +
			'<p> This is the "replace next" dynamic page creation example, which never reaches the first/last application page.</p>' +
			'<p>This page has been created/replaced dynamically, without any previous HTML code declaration.</p>' +
			'<a href="#0">previous page</a> | <a href="#2">next page</a></div>', 'modalWindow');
	// Set the new created page callbacks:
	dynamicPageElement.onShow = function(queryData, referrerElement) {
		if (libro.isLogEnabled()) logMonitor.innerHTML = logMonitor.innerHTML + '<br>' + (new Date().toLocaleString()) + ': <span style="color:#444;">"dynamicPage:' + dynamicPageElement.id + '".onShow(' + queryData + ', ' + (referrerElement? referrerElement.id: '') + ')</span>';
		createNextPage(dynamicPageElement);
		createPreviousPage(dynamicPageElement);
		dynamicPagesIds = ["0", "1", "2"];
	};
	dynamicPageElement.onHide = dynamicOnHide;
	// Go to the new created page:
	window.location.hash = dynamicPageElement.id;
}
function dynamicOnHide(nextQueryData, nextElement) {
	if (libro.isLogEnabled()) logMonitor.innerHTML = logMonitor.innerHTML + '<br>' + (new Date().toLocaleString()) + ': <span style="color:#444;">"dynamicPage:' + this.id + '".onHide(' + nextQueryData + ', ' + (nextElement? nextElement.id: '') + ')</span>';
	if (nextElement && isNaN(nextElement.id)) {
		dynamicPagesIds.forEach(function(item, index) {
			libro.deletePage(item);
		})
		dynamicPagesIds = [];
	}
}
function createNextPage(currentPageElement) {
	var currentIdIntValue = parseInt(currentPageElement.id);
	var nextPageId = (currentIdIntValue + 1).toString();
	var nextPageElement = document.getElementById(nextPageId);
	if (!nextPageElement) {
		nextPageElement = libro.createPage('<div class="page" id="' + nextPageId + '">' +
				'<h1>LibroJS - Page ' + nextPageId + '</h1>' +
				'<p>This is the "replace next" dynamic page creation example, which never reaches the first/last application page.</p>' +
				'<p>This page has been created/replaced dynamically, without any previous HTML code declaration.</p>' +
				'<a href="#' + currentPageElement.id + '">previous page</a> | ' +
				'<a href="#' + (currentIdIntValue + 2).toString() + '">next page</a></div>', 'modalWindow');
	}
	nextPageElement.onShow = function(queryData, referrerElement) {
		if (libro.isLogEnabled()) logMonitor.innerHTML = logMonitor.innerHTML + '<br>' + (new Date().toLocaleString()) + ': <span style="color:#444;">"dynamicPage:' + this.id + '".onShow(' + queryData + ', ' + (referrerElement? referrerElement.id: '') + ')</span>';
		createNextPage(nextPageElement);
		createPreviousPage(nextPageElement);
		dynamicPagesIds = [currentIdIntValue.toString(), nextPageId, (currentIdIntValue + 2).toString()];
		libro.deletePage((currentIdIntValue - 1).toString());
		this.onHide = dynamicOnHide;
	};
}
function createPreviousPage(currentPageElement) {
	var currentIdIntValue = parseInt(currentPageElement.id);
	var previousPageId = (currentIdIntValue - 1).toString();
	var previousPageElement = document.getElementById(previousPageId);
	if (!previousPageElement) {
		previousPageElement = libro.createPage('<div class="page" id="' + previousPageId + '">' +
				'<h1>LibroJS - Page ' + previousPageId + '</h1>' +
				'<p>This is the "replace next" dynamic page creation example, which never reaches the first/last application page.</p>' +
				'<p>This page has been created/replaced dynamically, without any previous HTML code declaration.</p>' +
				'<a href="#' + (currentIdIntValue - 2).toString() + '">previous page</a> | ' +
				'<a href="#' + currentPageElement.id + '">next page</a></div>', currentPageElement.id);
	}
	previousPageElement.onShow = function(queryData, referrerElement) {
		if (libro.isLogEnabled()) logMonitor.innerHTML = logMonitor.innerHTML + '<br>' + (new Date().toLocaleString()) + ': <span style="color:#444;">"dynamicPage:' + this.id + '".onShow(' + queryData + ', ' + (referrerElement? referrerElement.id: '') + ')</span>';
		createPreviousPage(previousPageElement);
		createNextPage(previousPageElement);
		dynamicPagesIds = [(currentIdIntValue - 2).toString(), previousPageId, currentIdIntValue.toString()];
		libro.deletePage((currentIdIntValue + 1).toString());
		this.onHide = dynamicOnHide;
	};
}

// Create command button prompt and execute action:
function executeCommand() {
	var command = prompt('Type the command to be executed:');
	logMonitor.innerHTML = logMonitor.innerHTML + '<br>' + (new Date().toLocaleString()) + ': <span style="color:green;">command... ' +
		'<br>&nbsp;&nbsp;&nbsp;&nbsp;input: ' + command +
		'<br>&nbsp;&nbsp;&nbsp;&nbsp;output: ' + eval(command);
}
</script>

</body>

</html>
